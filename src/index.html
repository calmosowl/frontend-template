<!DOCTYPE html>
<html lang="ru">
<head>
    //= modules/meta.html
</head>

<body>
    <header role="banner">
        //= modules/header.html
    </header>
    <main role="main" style="padding: 20px 20px">
		<style>
        pre{
    height: 20em;
    font-family: monospace;
    font-size: 1em;
    padding: 2px 5px;
    color: rgb(233, 225, 217);
    background-color: #212121;
    border: 1px solid #030;
    border-radius: 4px;
    overflow: auto;
}</style>		
		<output style="font-size: 18px; font-weight: 600; font-family: 'Ubuntu Mono', monospace;" id="output">0</output><br>
		<button id="tickPlay">PLAY</button>
		<button id="tickStop">STOP</button>
		<button id="getValue">GET VALUE</button>
        <!-- <button onclick="myFunction()">Click me to start the animation.</button> -->
        <button id="rollMove">Push this shit</button>
        <button id="test">TEST</button>
        <pre id="log">Event information log
=====================
</pre>
<script>
/*"use strict";
document.addEventListener("DOMContentLoaded", (ev) => {
	(()=>{*/
var rollerSeven = document.getElementById('rollerSeven'),
	test = document.getElementById('test');

function findKeyframesRule(rule)
    {
        // gather all stylesheets into an array
        var ss = document.styleSheets;
        
        // loop through the stylesheets
        for (var i = 0; i < ss.length; ++i) {
            
            // loop through all the rules
            //document.styleSheets[0].rules[42].cssText
            for (var j = 0; j < ss[i].rules.length; ++j) {
                
                // find the -webkit-keyframe rule whose name matches our passed over parameter and return that rule
                if (ss[i].rules[j].type == 7 && ss[i].rules[j].name == rule)
                    return ss[i].rules[j].cssRules;
            }
        }
        
        // rule not found
        return null;
    }
// remove old keyframes and add new ones
function change(anim, el)
    {
        // find our -webkit-keyframe rule
        var keyframes = findKeyframesRule("spin");
        
        // remove the existing 0% and 100% rules
        keyframes.deleteRule("0%");
        keyframes.deleteRule("100%");
        
        // create new 0% and 100% rules with random numbers
        keyframes.appendRule("0% { -webkit-transform: rotate("+randomFromTo(-360,360)+"deg); }");
        keyframes.appendRule("100% { -webkit-transform: rotate("+randomFromTo(-360,360)+"deg); }");
        
        // assign the animation to our element (which will cause the animation to run)
        el.style.webkitAnimationName = "spin";
    }


function startChange(el)
    {
        // remove the old animation from our object
        el.style.webkitAnimationName = "none";
        
        // call the change method, which will update the keyframe animation
        setTimeout(function(){change("rotate", rollerSeven);}, 0);
    }
test.onclick= (ev) => {
			ev.preventDefault();
			startChange(rollerSeven);
		};

var keyframes = findKeyframesRule("spin");
// Makes an array of the current percent values
// in the animation
var keyframeString = [];  
for(var i = 0; i < keyframes.length; i++)
{
  keyframeString.push(keyframes[i].keyText); 
}
  
// Removes all the % values from the array so
// the getClosest function can perform calculations
var keys = keyframeString.map(function(str) {
  return str.replace('%', '');
});




/*	})();
}, false);*/
</script>

    </main>
</body>
</html>
